-- Run this inside your python script or a separate init_db.py
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT UNIQUE,
    password_hash TEXT
);

CREATE TABLE learning_sessions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER,
    topic TEXT, -- e.g., "Phishing", "Firewalls"
    current_difficulty INTEGER DEFAULT 1, -- The core adaptive metric (1-5)
    streak_count INTEGER DEFAULT 0,       -- To trigger level-ups
    FOREIGN KEY(user_id) REFERENCES users(id)
);

CREATE TABLE chat_history (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    session_id INTEGER,
    sender TEXT, -- 'user' or 'ai'
    message TEXT,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY(session_id) REFERENCES learning_sessions(id)
);